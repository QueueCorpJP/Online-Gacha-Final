# SHIJON - ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ ã‚¬ãƒãƒ£ & ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚«ãƒ¼ãƒ‰ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

> **ç¾ä»£çš„ãªã‚ªãƒ³ãƒ©ã‚¤ãƒ³ ã‚¬ãƒãƒ£ä½“é¨“ã‚’æä¾›ã™ã‚‹åŒ…æ‹¬çš„ãªWebãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **

SHIJONã¯ã€Next.jsï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰ã¨NestJSï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰ã§æ§‹ç¯‰ã•ã‚ŒãŸã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ ã‚¬ãƒãƒ£ & ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚«ãƒ¼ãƒ‰ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¼”å‡ºã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ ã€åŒ…æ‹¬çš„ãªç®¡ç†æ©Ÿèƒ½ã‚’æä¾›ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æœ€é«˜ã®ã‚¬ãƒãƒ£ä½“é¨“ã‚’å±Šã‘ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

1. [ğŸŒŸ æ©Ÿèƒ½æ¦‚è¦](#-æ©Ÿèƒ½æ¦‚è¦)
2. [ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ï¸-ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°](#ï¸-æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°)
4. [ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](#-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ)
5. [ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](#-ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰)
6. [ğŸ”§ è¨­å®šè©³ç´°](#-è¨­å®šè©³ç´°)
7. [ğŸ“š APIä»•æ§˜](#-apiä»•æ§˜)
8. [ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…](#-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…)
9. [ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ](#-ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ)
10. [ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥](#-ãƒ†ã‚¹ãƒˆæˆ¦ç•¥)
11. [ğŸ” ç›£è¦–ãƒ»ãƒ­ã‚°](#-ç›£è¦–ãƒ­ã‚°)
12. [ğŸ¤ é–‹ç™ºã‚¬ã‚¤ãƒ‰](#-é–‹ç™ºã‚¬ã‚¤ãƒ‰)

---

## ğŸŒŸ æ©Ÿèƒ½æ¦‚è¦

### ğŸ° ã‚¬ãƒãƒ£ã‚·ã‚¹ãƒ†ãƒ 

#### ğŸ¯ åŸºæœ¬ã‚¬ãƒãƒ£æ©Ÿèƒ½
- **å˜ç™ºã‚¬ãƒãƒ£**: 1å›å¼•ãã§ã®å€‹åˆ¥ä½“é¨“
- **10é€£ã‚¬ãƒãƒ£**: ã¾ã¨ã‚ã¦å¼•ããŠå¾—ãªãƒ‘ãƒƒã‚¯
- **ç‰¹åˆ¥ã‚¬ãƒãƒ£**: æœŸé–“é™å®šãƒ»ã‚¤ãƒ™ãƒ³ãƒˆé™å®šã‚¬ãƒãƒ£
- **ã‚¹ãƒ†ãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¬ãƒãƒ£**: æ®µéšçš„ã«ç¢ºç‡ãŒä¸ŠãŒã‚‹ã‚·ã‚¹ãƒ†ãƒ 

#### ğŸ¬ æ¼”å‡ºã‚·ã‚¹ãƒ†ãƒ 
- **å‹•ç”»æ¼”å‡º**: WebM/MP4å½¢å¼ã§ã®é«˜å“è³ªæ¼”å‡º
- **ãƒ¬ã‚¢ãƒªãƒ†ã‚£åˆ¥æ¼”å‡º**: ãƒ¬ã‚¢åº¦ã«å¿œã˜ãŸç•°ãªã‚‹æ¼”å‡º
- **ã‚¹ã‚­ãƒƒãƒ—æ©Ÿèƒ½**: æ¼”å‡ºã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦çµæœè¡¨ç¤º
- **æ¼”å‡ºã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**: ç®¡ç†è€…ã«ã‚ˆã‚‹æ¼”å‡ºè¨­å®š

#### ğŸ† ãƒ¬ã‚¢ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ 
- **Normal (N)**: åŸºæœ¬ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼ˆç¢ºç‡: 70%ï¼‰
- **Rare (R)**: ä¸­ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼ˆç¢ºç‡: 25%ï¼‰
- **Super Rare (SR)**: æœ€é«˜ãƒ¬ã‚¢ãƒªãƒ†ã‚£ï¼ˆç¢ºç‡: 5%ï¼‰
- **å‹•çš„ç¢ºç‡èª¿æ•´**: ç®¡ç†è€…ã«ã‚ˆã‚‹ç¢ºç‡è¨­å®š

#### ğŸ“¦ åœ¨åº«ç®¡ç†
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åœ¨åº«æ›´æ–°**: WebSocketã«ã‚ˆã‚‹å³åº§ã®åœ¨åº«åæ˜ 
- **åœ¨åº«åˆ‡ã‚Œè¡¨ç¤º**: åœ¨åº«0æ™‚ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- **åœ¨åº«ã‚¢ãƒ©ãƒ¼ãƒˆ**: ç®¡ç†è€…å‘ã‘åœ¨åº«ä¸è¶³é€šçŸ¥
- **è‡ªå‹•è£œå……**: è¨­å®šã«åŸºã¥ãè‡ªå‹•åœ¨åº«è£œå……

### ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

#### ğŸ” èªè¨¼ãƒ»èªå¯
- **å¤šæ®µéšèªè¨¼**: ãƒ¡ãƒ¼ãƒ« + OTPèªè¨¼
- **JWT Token**: ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: è‡ªå‹•ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªã‚·ãƒ¼**: å¼·åº¦æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 

#### ğŸ“ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç®¡ç†
- **åŸºæœ¬æƒ…å ±ç®¡ç†**: æ°åã€ä½æ‰€ã€é›»è©±ç•ªå·
- **ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ**: S3é€£æºã§ã®ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- **è¨­å®šç®¡ç†**: è¨€èªè¨­å®šã€é€šçŸ¥è¨­å®š
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤**: GDPRæº–æ‹ ã®å®Œå…¨å‰Šé™¤

#### ğŸ·ï¸ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçŠ¶æ…‹
- **Active**: é€šå¸¸åˆ©ç”¨å¯èƒ½çŠ¶æ…‹
- **Inactive**: ãƒ¡ãƒ¼ãƒ«èªè¨¼å¾…ã¡çŠ¶æ…‹
- **Suspended**: ä¸€æ™‚åœæ­¢çŠ¶æ…‹
- **Banned**: æ°¸ä¹…åˆ©ç”¨åœæ­¢çŠ¶æ…‹

### ğŸ’° æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ 

#### ğŸ’³ æ±ºæ¸ˆæ–¹æ³•
- **Stripeæ±ºæ¸ˆ**: 
  - ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆ
  - Apple Pay / Google Pay
  - SEPAæ±ºæ¸ˆï¼ˆæ¬§å·ï¼‰
- **PayPayæ±ºæ¸ˆ**:
  - QRã‚³ãƒ¼ãƒ‰æ±ºæ¸ˆ
  - PayPayæ®‹é«˜æ±ºæ¸ˆ
  - PayPayã‚ã¨æ‰•ã„

#### ğŸª™ å†…éƒ¨é€šè²¨ã‚·ã‚¹ãƒ†ãƒ 
- **ã‚³ã‚¤ãƒ³ç®¡ç†**: ã‚¬ãƒãƒ£è³¼å…¥ç”¨å†…éƒ¨é€šè²¨
- **è‡ªå‹•ãƒãƒ£ãƒ¼ã‚¸**: æ®‹é«˜ä¸è¶³æ™‚ã®è‡ªå‹•è£œå……
- **ãƒ¬ãƒ¼ãƒˆè¨­å®š**: 1å†† = 1ã‚³ã‚¤ãƒ³ã®å›ºå®šãƒ¬ãƒ¼ãƒˆ
- **å±¥æ­´ç®¡ç†**: å…¨å–å¼•å±¥æ­´ã®è¨˜éŒ²

#### ğŸ¯ ãƒã‚¤ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
- **ç²å¾—ãƒã‚¤ãƒ³ãƒˆ**: ã‚¬ãƒãƒ£çµæœã«åŸºã¥ããƒã‚¤ãƒ³ãƒˆä»˜ä¸
- **äº¤æ›ã‚·ã‚¹ãƒ†ãƒ **: ã‚¢ã‚¤ãƒ†ãƒ  â†’ ãƒã‚¤ãƒ³ãƒˆå¤‰æ›
- **æœ‰åŠ¹æœŸé™**: ãƒã‚¤ãƒ³ãƒˆã®æœŸé™ç®¡ç†
- **ãƒ©ãƒ³ã‚­ãƒ³ã‚°**: ãƒã‚¤ãƒ³ãƒˆé †ä½ã‚·ã‚¹ãƒ†ãƒ 

### ğŸ æ‹›å¾…ã‚·ã‚¹ãƒ†ãƒ 

#### ğŸ“² æ‹›å¾…ã‚³ãƒ¼ãƒ‰æ©Ÿèƒ½
- **ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ**: UUIDåŸºç›¤ã®8æ–‡å­—ã‚³ãƒ¼ãƒ‰
- **æœ‰åŠ¹æœŸé™è¨­å®š**: 7æ—¥é–“ã®æœ‰åŠ¹æœŸé™
- **ä½¿ç”¨çŠ¶æ³è¿½è·¡**: æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã®ä½¿ç”¨å±¥æ­´
- **çµ±è¨ˆæƒ…å ±**: æ‹›å¾…æˆåŠŸç‡ã®åˆ†æ

#### ğŸ’ ç´¹ä»‹å ±é…¬ã‚·ã‚¹ãƒ†ãƒ 
- **1%é‚„å…ƒ**: è¢«æ‹›å¾…è€…ã®èª²é‡‘é¡ã®1%ã‚’ãƒã‚¤ãƒ³ãƒˆé‚„å…ƒ
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨ˆç®—**: èª²é‡‘ç™ºç”Ÿæ™‚ã®å³åº§é‚„å…ƒ
- **ä¸Šé™è¨­å®š**: æœˆé–“é‚„å…ƒä¸Šé™ã®è¨­å®š
- **å±¥æ­´ç®¡ç†**: é‚„å…ƒå±¥æ­´ã®è©³ç´°è¨˜éŒ²

### ğŸ“¦ åœ¨åº«ãƒ»è³å“ç®¡ç†

#### ğŸ“Š åœ¨åº«ç®¡ç†
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**: å³åº§ã®åœ¨åº«åæ˜ ã‚·ã‚¹ãƒ†ãƒ 
- **åœ¨åº«ã‚¢ãƒ©ãƒ¼ãƒˆ**: è¨­å®šå€¤ä»¥ä¸‹ã§ã®è‡ªå‹•é€šçŸ¥
- **åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: åœ¨åº«çŠ¶æ³ã®å¯è¦–åŒ–
- **äºˆæ¸¬æ©Ÿèƒ½**: éœ€è¦äºˆæ¸¬ã«åŸºã¥ãåœ¨åº«ææ¡ˆ

#### ğŸ† è³å“ç®¡ç†
- **ãƒ‡ã‚¸ã‚¿ãƒ«è³å“**: NFTã‚«ãƒ¼ãƒ‰ã€ã‚²ãƒ¼ãƒ å†…ã‚¢ã‚¤ãƒ†ãƒ 
- **ç‰©ç†è³å“**: å®Ÿç‰©ã‚«ãƒ¼ãƒ‰ã€ã‚°ãƒƒã‚ºã®é…é€ç®¡ç†
- **äº¤æ›ã‚·ã‚¹ãƒ†ãƒ **: ãƒ‡ã‚¸ã‚¿ãƒ« â†” ãƒã‚¤ãƒ³ãƒˆå¤‰æ›
- **é…é€è¿½è·¡**: ç‰©ç†è³å“ã®é…é€çŠ¶æ³ç®¡ç†

### ğŸ”— å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº

#### ğŸ“± LINEé€£æº
- **LINE Bot**: å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æº
- **é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ **: ã‚¬ãƒãƒ£çµæœã€ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é€šçŸ¥
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼**: LINE IDã§ã®ç°¡å˜ãƒ­ã‚°ã‚¤ãƒ³
- **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é…ä¿¡**: ã‚»ã‚°ãƒ¡ãƒ³ãƒˆé…ä¿¡æ©Ÿèƒ½

#### â˜ï¸ AWS ã‚µãƒ¼ãƒ“ã‚¹
- **S3ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: ç”»åƒãƒ»å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
- **CloudFront CDN**: é«˜é€Ÿã‚³ãƒ³ãƒ†ãƒ³ãƒ„é…ä¿¡
- **SES**: å¤§é‡ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚µãƒ¼ãƒ“ã‚¹
- **Lambda**: ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å‡¦ç†

#### ğŸ“§ ãƒ¡ãƒ¼ãƒ«é€šçŸ¥
- **å–å¼•é€šçŸ¥**: æ±ºæ¸ˆå®Œäº†ã€ã‚¬ãƒãƒ£çµæœ
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é€šçŸ¥**: ãƒ­ã‚°ã‚¤ãƒ³æ¤œçŸ¥ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
- **ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°**: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã€æ–°å•†å“æ¡ˆå†…
- **ã‚·ã‚¹ãƒ†ãƒ é€šçŸ¥**: ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã€éšœå®³æƒ…å ±

### ğŸ“± å¤šè¨€èªãƒ»å¤šåœ°åŸŸå¯¾å¿œ

#### ğŸŒ è¨€èªã‚µãƒãƒ¼ãƒˆ
- **æ—¥æœ¬èª**: ãƒ¡ã‚¤ãƒ³è¨€èªï¼ˆå®Œå…¨å¯¾å¿œï¼‰
- **è‹±èª**: ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹å¯¾å¿œ
- **ä¸­å›½èª**: ã‚¢ã‚¸ã‚¢å¸‚å ´å¯¾å¿œ
- **å‹•çš„åˆ‡æ›¿**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨€èªå¤‰æ›´

#### ğŸ•˜ ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¯¾å¿œ
- **è‡ªå‹•æ¤œå‡º**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³è‡ªå‹•è¨­å®š
- **æ™‚åˆ»è¡¨ç¤º**: ç¾åœ°æ™‚é–“ã§ã®è¡¨ç¤º
- **ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†**: åœ°åŸŸåˆ¥ã‚¤ãƒ™ãƒ³ãƒˆæ™‚é–“ç®¡ç†

### ğŸ“Š ç®¡ç†ãƒ»åˆ†ææ©Ÿèƒ½

#### ğŸ›ï¸ ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- **å£²ä¸Šåˆ†æ**: æ—¥åˆ¥ãƒ»æœˆåˆ¥å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆ
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ†æ**: ç™»éŒ²æ•°ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ç‡
- **ã‚¬ãƒãƒ£åˆ†æ**: äººæ°—ã‚¬ãƒãƒ£ã€åç›Šæ€§åˆ†æ
- **åœ¨åº«ç®¡ç†**: åœ¨åº«çŠ¶æ³ã€è£œå……ææ¡ˆ

#### ğŸ“ˆ ãƒ¬ãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ 
- **å£²ä¸Šãƒ¬ãƒãƒ¼ãƒˆ**: CSV/PDFå½¢å¼ã§ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ**: è¡Œå‹•åˆ†æã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†æ
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒãƒ¼ãƒˆ**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ã‚¨ãƒ©ãƒ¼ç‡
- **ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒãƒ¼ãƒˆ**: ç®¡ç†è€…å®šç¾©ã®ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ğŸ“ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
graph TB
    subgraph "Frontend Layer"
        A[Next.js App] --> B[Redux Store]
        A --> C[UI Components]
        A --> D[API Client]
    end
    
    subgraph "Backend Layer"
        E[NestJS API] --> F[Authentication]
        E --> G[Business Logic]
        E --> H[Database Layer]
    end
    
    subgraph "External Services"
        I[AWS S3]
        J[Stripe API]
        K[PayPay API]
        L[LINE Bot API]
        M[SMTP Server]
    end
    
    subgraph "Infrastructure"
        N[PostgreSQL]
        O[Redis Cache]
        P[File Storage]
    end
    
    D --> E
    E --> I
    E --> J
    E --> K
    E --> L
    E --> M
    H --> N
    H --> O
    H --> P
```

### ğŸŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ è©³ç´°
```
frontend/
â”œâ”€â”€ ğŸ“± app/                    # Next.js App Router
â”‚   â”œâ”€â”€ ğŸ  (home)/           # ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã‚°ãƒ«ãƒ¼ãƒ—
â”‚   â”œâ”€â”€ ğŸ” (auth)/           # èªè¨¼é–¢é€£ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”œâ”€â”€ signup/
â”‚   â”‚   â”œâ”€â”€ verify-otp/
â”‚   â”‚   â””â”€â”€ reset-password/
â”‚   â”œâ”€â”€ ğŸ° gacha/            # ã‚¬ãƒãƒ£é–¢é€£
â”‚   â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â””â”€â”€ result/
â”‚   â”œâ”€â”€ ğŸ‘¤ profile/          # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”œâ”€â”€ inventory/
â”‚   â”‚   â”œâ”€â”€ invite/
â”‚   â”‚   â””â”€â”€ points/
â”‚   â”œâ”€â”€ ğŸ’° payment/          # æ±ºæ¸ˆé–¢é€£
â”‚   â”‚   â”œâ”€â”€ charge/
â”‚   â”‚   â””â”€â”€ success/
â”‚   â”œâ”€â”€ ğŸ”§ admin/            # ç®¡ç†è€…å°‚ç”¨
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”œâ”€â”€ gacha/
â”‚   â”‚   â””â”€â”€ reports/
â”‚   â””â”€â”€ ğŸ“ (legal)/          # æ³•çš„æ–‡æ›¸
â”‚       â”œâ”€â”€ terms/
â”‚       â”œâ”€â”€ privacy/
â”‚       â””â”€â”€ about/
â”œâ”€â”€ ğŸ§© components/           # å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ui/                  # åŸºæœ¬UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ forms/               # ãƒ•ã‚©ãƒ¼ãƒ é–¢é€£
â”‚   â”œâ”€â”€ gacha/               # ã‚¬ãƒãƒ£å°‚ç”¨
â”‚   â”œâ”€â”€ profile/             # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å°‚ç”¨
â”‚   â””â”€â”€ admin/               # ç®¡ç†è€…å°‚ç”¨
â”œâ”€â”€ ğŸ—ƒï¸ redux/               # çŠ¶æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ store.ts
â”‚   â””â”€â”€ features/
â”‚       â”œâ”€â”€ authSlice.ts
â”‚       â”œâ”€â”€ gachaSlice.ts
â”‚       â”œâ”€â”€ userSlice.ts
â”‚       â””â”€â”€ adminSlice.ts
â”œâ”€â”€ ğŸ”§ lib/                 # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ axios.ts
â”‚   â”œâ”€â”€ utils.ts
â”‚   â””â”€â”€ constants.ts
â”œâ”€â”€ ğŸª hooks/               # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useGacha.ts
â”‚   â””â”€â”€ useLocalization.ts
â”œâ”€â”€ ğŸŒ locales/             # å¤šè¨€èªå¯¾å¿œ
â”‚   â”œâ”€â”€ ja.json
â”‚   â”œâ”€â”€ en.json
â”‚   â””â”€â”€ zh.json
â””â”€â”€ ğŸ¨ styles/              # ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
    â”œâ”€â”€ globals.css
    â””â”€â”€ components.css
```

#### ğŸ”„ çŠ¶æ…‹ç®¡ç†æ§‹é€ 
```typescript
// Redux Storeæ§‹é€ 
interface RootState {
  auth: {
    user: User | null
    token: string | null
    isLoading: boolean
    error: string | null
  }
  gacha: {
    availableGacha: Gacha[]
    currentResult: GachaResult | null
    inventory: InventoryItem[]
    loading: boolean
  }
  payment: {
    coinBalance: number
    pointBalance: number
    transactions: Transaction[]
    loading: boolean
  }
  admin: {
    dashboard: DashboardData
    users: User[]
    reports: Report[]
    loading: boolean
  }
}
```

### âš™ï¸ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### ğŸ“ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹é€ è©³ç´°
```
backend/src/
â”œâ”€â”€ ğŸ” modules/
â”‚   â”œâ”€â”€ ğŸ†” auth/             # èªè¨¼ãƒ»èªå¯
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”œâ”€â”€ auth.module.ts
â”‚   â”‚   â”œâ”€â”€ strategies/
â”‚   â”‚   â”‚   â”œâ”€â”€ jwt.strategy.ts
â”‚   â”‚   â”‚   â””â”€â”€ local.strategy.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â”œâ”€â”€ otp.entity.ts
â”‚   â”‚       â””â”€â”€ blacklisted-token.entity.ts
â”‚   â”œâ”€â”€ ğŸ‘¤ user/             # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â”œâ”€â”€ user.module.ts
â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ create-user.dto.ts
â”‚   â”‚   â”‚   â””â”€â”€ update-user.dto.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ user.entity.ts
â”‚   â”œâ”€â”€ ğŸ° gacha/            # ã‚¬ãƒãƒ£ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”œâ”€â”€ gacha.controller.ts
â”‚   â”‚   â”œâ”€â”€ gacha.service.ts
â”‚   â”‚   â”œâ”€â”€ gacha.module.ts
â”‚   â”‚   â”œâ”€â”€ engines/
â”‚   â”‚   â”‚   â”œâ”€â”€ probability.engine.ts
â”‚   â”‚   â”‚   â””â”€â”€ result.engine.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â”œâ”€â”€ gacha.entity.ts
â”‚   â”‚       â”œâ”€â”€ gacha-item.entity.ts
â”‚   â”‚       â””â”€â”€ gacha-result.entity.ts
â”‚   â”œâ”€â”€ ğŸ’° payments/         # æ±ºæ¸ˆå‡¦ç†
â”‚   â”‚   â”œâ”€â”€ payments.controller.ts
â”‚   â”‚   â”œâ”€â”€ payments.service.ts
â”‚   â”‚   â”œâ”€â”€ payments.module.ts
â”‚   â”‚   â”œâ”€â”€ providers/
â”‚   â”‚   â”‚   â”œâ”€â”€ stripe.provider.ts
â”‚   â”‚   â”‚   â””â”€â”€ paypay.provider.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â”œâ”€â”€ payment.entity.ts
â”‚   â”‚       â””â”€â”€ transaction.entity.ts
â”‚   â”œâ”€â”€ ğŸ invite/           # æ‹›å¾…ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”œâ”€â”€ invite.controller.ts
â”‚   â”‚   â”œâ”€â”€ invite.service.ts
â”‚   â”‚   â”œâ”€â”€ invite.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ invite-code.entity.ts
â”‚   â”œâ”€â”€ ğŸ“¦ inventory/        # åœ¨åº«ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ inventory.controller.ts
â”‚   â”‚   â”œâ”€â”€ inventory.service.ts
â”‚   â”‚   â”œâ”€â”€ inventory.module.ts
â”‚   â”‚   â”œâ”€â”€ jobs/
â”‚   â”‚   â”‚   â””â”€â”€ stock-alert.job.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â”œâ”€â”€ inventory.entity.ts
â”‚   â”‚       â””â”€â”€ inventory-log.entity.ts
â”‚   â”œâ”€â”€ ğŸ† prizes/           # è³å“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ prizes.controller.ts
â”‚   â”‚   â”œâ”€â”€ prizes.service.ts
â”‚   â”‚   â”œâ”€â”€ prizes.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ prize.entity.ts
â”‚   â”œâ”€â”€ ğŸª™ coin/             # ã‚³ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”œâ”€â”€ coin.controller.ts
â”‚   â”‚   â”œâ”€â”€ coin.service.ts
â”‚   â”‚   â”œâ”€â”€ coin.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ coin-transaction.entity.ts
â”‚   â”œâ”€â”€ ğŸ¯ points/           # ãƒã‚¤ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”œâ”€â”€ points.controller.ts
â”‚   â”‚   â”œâ”€â”€ points.service.ts
â”‚   â”‚   â”œâ”€â”€ points.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ points-transaction.entity.ts
â”‚   â”œâ”€â”€ ğŸ“± line/             # LINEé€£æº
â”‚   â”‚   â”œâ”€â”€ line.controller.ts
â”‚   â”‚   â”œâ”€â”€ line.service.ts
â”‚   â”‚   â”œâ”€â”€ line.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ line-settings.entity.ts
â”‚   â”œâ”€â”€ â˜ï¸ s3/              # AWS S3é€£æº
â”‚   â”‚   â”œâ”€â”€ s3.service.ts
â”‚   â”‚   â””â”€â”€ s3.module.ts
â”‚   â”œâ”€â”€ ğŸ“§ mail/             # ãƒ¡ãƒ¼ãƒ«é€ä¿¡
â”‚   â”‚   â”œâ”€â”€ mail.service.ts
â”‚   â”‚   â”œâ”€â”€ mail.module.ts
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â”œâ”€â”€ welcome.hbs
â”‚   â”‚       â”œâ”€â”€ otp.hbs
â”‚   â”‚       â””â”€â”€ password-reset.hbs
â”‚   â”œâ”€â”€ ğŸ“° news-blog/        # ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»ãƒ–ãƒ­ã‚°
â”‚   â”‚   â”œâ”€â”€ news-blog.controller.ts
â”‚   â”‚   â”œâ”€â”€ news-blog.service.ts
â”‚   â”‚   â”œâ”€â”€ news-blog.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ news-blog.entity.ts
â”‚   â”œâ”€â”€ â“ faqs/             # FAQ
â”‚   â”‚   â”œâ”€â”€ faqs.controller.ts
â”‚   â”‚   â”œâ”€â”€ faqs.service.ts
â”‚   â”‚   â”œâ”€â”€ faqs.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ faq.entity.ts
â”‚   â”œâ”€â”€ ğŸ“‚ category/         # ã‚«ãƒ†ã‚´ãƒªç®¡ç†
â”‚   â”‚   â”œâ”€â”€ category.controller.ts
â”‚   â”‚   â”œâ”€â”€ category.service.ts
â”‚   â”‚   â”œâ”€â”€ category.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ category.entity.ts
â”‚   â”œâ”€â”€ ğŸ”” notifications/    # é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”œâ”€â”€ notifications.controller.ts
â”‚   â”‚   â”œâ”€â”€ notifications.service.ts
â”‚   â”‚   â”œâ”€â”€ notifications.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ notification.entity.ts
â”‚   â”œâ”€â”€ ğŸ”’ security/         # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°
â”‚   â”‚   â”œâ”€â”€ security.service.ts
â”‚   â”‚   â”œâ”€â”€ security.module.ts
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â””â”€â”€ security-log.entity.ts
â”‚   â”œâ”€â”€ ğŸ“Š reporting/        # ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ reporting.controller.ts
â”‚   â”‚   â”œâ”€â”€ reporting.service.ts
â”‚   â”‚   â”œâ”€â”€ reporting.module.ts
â”‚   â”‚   â””â”€â”€ generators/
â”‚   â”‚       â”œâ”€â”€ sales.generator.ts
â”‚   â”‚       â””â”€â”€ user.generator.ts
â”‚   â””â”€â”€ ğŸ› ï¸ admin/           # ç®¡ç†æ©Ÿèƒ½
â”‚       â”œâ”€â”€ admin.controller.ts
â”‚       â”œâ”€â”€ admin.service.ts
â”‚       â””â”€â”€ admin.module.ts
â”œâ”€â”€ ğŸ”§ common/              # å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ guards/
â”‚   â”‚   â”œâ”€â”€ auth.guard.ts
â”‚   â”‚   â”œâ”€â”€ roles.guard.ts
â”‚   â”‚   â””â”€â”€ throttle.guard.ts
â”‚   â”œâ”€â”€ decorators/
â”‚   â”‚   â”œâ”€â”€ current-user.decorator.ts
â”‚   â”‚   â”œâ”€â”€ roles.decorator.ts
â”‚   â”‚   â””â”€â”€ public.decorator.ts
â”‚   â”œâ”€â”€ filters/
â”‚   â”‚   â”œâ”€â”€ http-exception.filter.ts
â”‚   â”‚   â””â”€â”€ validation.filter.ts
â”‚   â”œâ”€â”€ interceptors/
â”‚   â”‚   â”œâ”€â”€ transform.interceptor.ts
â”‚   â”‚   â””â”€â”€ logging.interceptor.ts
â”‚   â”œâ”€â”€ pipes/
â”‚   â”‚   â””â”€â”€ validation.pipe.ts
â”‚   â””â”€â”€ enums/
â”‚       â”œâ”€â”€ user-roles.enum.ts
â”‚       â””â”€â”€ payment-status.enum.ts
â”œâ”€â”€ âš™ï¸ config/              # è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ database.config.ts
â”‚   â”œâ”€â”€ jwt.config.ts
â”‚   â”œâ”€â”€ stripe.config.ts
â”‚   â”œâ”€â”€ s3.config.ts
â”‚   â””â”€â”€ mail.config.ts
â””â”€â”€ ğŸ“¦ migrations/          # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    â”œâ”€â”€ 1699000000000-InitialTables.ts
    â”œâ”€â”€ 1699000001000-AddUserProfile.ts
    â”œâ”€â”€ 1699000002000-AddInviteSystem.ts
    â””â”€â”€ 1699000003000-AddPaymentTables.ts
```

---

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯è©³ç´°

### ğŸ–¥ï¸ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æŠ€è¡“

#### âš›ï¸ React/Next.js ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ 
- **Next.js 14**: App Routerã€Server Components
- **React 18**: Concurrent Featuresã€Suspense
- **TypeScript 5**: å‹å®‰å…¨æ€§ã€é–‹ç™ºä½“é¨“å‘ä¸Š

#### ğŸ¨ UI/UXãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **Tailwind CSS 3**: ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆCSS
- **Radix UI**: ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãªUIãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–
- **Framer Motion**: æ»‘ã‚‰ã‹ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
- **React Hook Form**: é«˜æ€§èƒ½ãƒ•ã‚©ãƒ¼ãƒ ç®¡ç†
- **Zod**: ã‚¹ã‚­ãƒ¼ãƒãƒ™ãƒ¼ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

#### ğŸ—ƒï¸ çŠ¶æ…‹ç®¡ç†
- **Redux Toolkit**: åŠ¹ç‡çš„ãªçŠ¶æ…‹ç®¡ç†
- **Redux Persist**: çŠ¶æ…‹ã®æ°¸ç¶šåŒ–
- **React Query**: ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ç®¡ç†
- **Zustand**: è»½é‡çŠ¶æ…‹ç®¡ç†ï¼ˆå±€æ‰€çš„ï¼‰

#### ğŸ”Œ HTTPé€šä¿¡ãƒ»API
- **Axios**: HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- **SWR**: ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°
- **Socket.io Client**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡

### âš™ï¸ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æŠ€è¡“

#### ğŸ—ï¸ ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ»ãƒ©ãƒ³ã‚¿ã‚¤ãƒ 
- **NestJS 10**: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰Node.jsãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Node.js 18**: LTSç‰ˆã§ã®å®‰å®šå‹•ä½œ
- **TypeScript 5**: å‹å®‰å…¨ãªã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰é–‹ç™º

#### ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ORM
- **PostgreSQL 15**: å …ç‰¢ãªãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **TypeORM 0.3**: TypeScript-first ORM
- **Redis 7**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- **Connection Pooling**: pgBouncerã«ã‚ˆã‚‹æ¥ç¶šç®¡ç†

#### ğŸ” èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- **JWT**: JSON Web Tokenèªè¨¼
- **bcrypt**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–
- **Passport.js**: èªè¨¼ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼
- **Helmet**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
- **Rate Limiting**: APIä½¿ç”¨é‡åˆ¶é™

#### ğŸ’° æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
- **Stripe API v2024**: ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆ
- **PayPay API v2**: QRæ±ºæ¸ˆãƒ»ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ±ºæ¸ˆ
- **Webhookå‡¦ç†**: éåŒæœŸæ±ºæ¸ˆé€šçŸ¥

#### â˜ï¸ å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹
- **AWS SDK v3**: ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ
- **Nodemailer**: SMTP ãƒ¡ãƒ¼ãƒ«é€ä¿¡
- **LINE Messaging API**: ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆé€£æº
- **Socket.io**: WebSocketã‚µãƒ¼ãƒãƒ¼

### ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©

#### ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ
- **ACIDæº–æ‹ **: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ•´åˆæ€§
- **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–**: ã‚¯ã‚¨ãƒªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
- **ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°**: å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿å¯¾å¿œ
- **ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: èª­ã¿æ›¸ãåˆ†é›¢

#### â˜ï¸ ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¤ãƒ³ãƒ•ãƒ©
- **AWS EC2**: ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **AWS S3**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- **AWS CloudFront**: CDNãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **AWS RDS**: ãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **AWS SES**: å¤§é‡ãƒ¡ãƒ¼ãƒ«é…ä¿¡

#### ğŸ”„ DevOpsãƒ»CI/CD
- **GitHub Actions**: è‡ªå‹•åŒ–ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- **Docker**: ã‚³ãƒ³ãƒ†ãƒŠåŒ–
- **PM2**: ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†
- **Nginx**: ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ãƒ»ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼
- **Let's Encrypt**: SSLè¨¼æ˜æ›¸è‡ªå‹•æ›´æ–°

### ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ»å“è³ªä¿è¨¼

#### ğŸ” ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Jest**: ãƒ¦ãƒ‹ãƒƒãƒˆãƒ»çµ±åˆãƒ†ã‚¹ãƒˆ
- **Supertest**: API ãƒ†ã‚¹ãƒˆ
- **Cypress**: E2Eãƒ†ã‚¹ãƒˆ
- **Storybook**: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ†ã‚¹ãƒˆ

#### ğŸ“ ã‚³ãƒ¼ãƒ‰å“è³ª
- **ESLint**: é™çš„è§£æãƒ»ã‚³ãƒ¼ãƒ‰è¦ç´„
- **Prettier**: ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- **Husky**: Git ãƒ•ãƒƒã‚¯
- **SonarQube**: ã‚³ãƒ¼ãƒ‰å“è³ªåˆ†æ

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ğŸ—ƒï¸ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–¢ä¿‚å›³ (ERå›³)

```mermaid
erDiagram
    User ||--o{ UserProfile : has
    User ||--o{ InviteCode : generates
    User ||--o{ GachaResult : performs
    User ||--o{ Payment : makes
    User ||--o{ CoinTransaction : has
    User ||--o{ PointsTransaction : has
    User ||--o{ InventoryItem : owns
    User ||--o{ SecurityLog : creates
    
    InviteCode ||--o{ User : referred_by
    
    Gacha ||--o{ GachaItem : contains
    Gacha ||--o{ GachaResult : produces
    
    GachaItem ||--o{ InventoryItem : becomes
    GachaItem ||--o{ Prize : links_to
    
    Payment ||--|| CoinTransaction : generates
    Payment ||--|| PointsTransaction : may_generate
    
    Category ||--o{ Gacha : categorizes
    Category ||--o{ Prize : categorizes
    
    Admin ||--o{ SecurityLog : reviews
```

### ğŸ—ï¸ ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ 

#### ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    username VARCHAR(50) UNIQUE,
    role user_role_enum DEFAULT 'user',
    status user_status_enum DEFAULT 'inactive',
    email_verified_at TIMESTAMP,
    referred_by INTEGER REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE user_profiles (
    id SERIAL PRIMARY KEY,
    user_id INTEGER UNIQUE REFERENCES users(id) ON DELETE CASCADE,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    phone VARCHAR(20),
    address TEXT,
    date_of_birth DATE,
    avatar_url VARCHAR(500),
    language VARCHAR(5) DEFAULT 'ja',
    timezone VARCHAR(50) DEFAULT 'Asia/Tokyo',
    notification_settings JSONB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- OTPèªè¨¼ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE otps (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    code VARCHAR(6) NOT NULL,
    purpose otp_purpose_enum NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    verified_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ğŸ° ã‚¬ãƒãƒ£é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
-- ã‚¬ãƒãƒ£ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE gachas (
    id SERIAL PRIMARY KEY,
    name VARCHAR(200) NOT NULL,
    description TEXT,
    category_id INTEGER REFERENCES categories(id),
    price INTEGER NOT NULL, -- ã‚³ã‚¤ãƒ³å˜ä½
    is_active BOOLEAN DEFAULT true,
    start_date TIMESTAMP,
    end_date TIMESTAMP,
    video_url VARCHAR(500),
    image_url VARCHAR(500),
    total_stock INTEGER DEFAULT 0,
    remaining_stock INTEGER DEFAULT 0,
    max_per_user INTEGER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ã‚¬ãƒãƒ£ã‚¢ã‚¤ãƒ†ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE gacha_items (
    id SERIAL PRIMARY KEY,
    gacha_id INTEGER REFERENCES gachas(id) ON DELETE CASCADE,
    prize_id INTEGER REFERENCES prizes(id),
    rarity rarity_enum NOT NULL,
    probability DECIMAL(5,4) NOT NULL, -- 0.0001 to 1.0000
    stock INTEGER DEFAULT 0,
    max_wins_per_user INTEGER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ã‚¬ãƒãƒ£çµæœãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE gacha_results (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    gacha_id INTEGER REFERENCES gachas(id),
    gacha_item_id INTEGER REFERENCES gacha_items(id),
    quantity INTEGER DEFAULT 1,
    points_awarded INTEGER DEFAULT 0,
    performed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ğŸ’° æ±ºæ¸ˆãƒ»çµŒæ¸ˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
-- æ±ºæ¸ˆãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE payments (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    amount DECIMAL(10,2) NOT NULL,
    currency VARCHAR(3) DEFAULT 'JPY',
    payment_method payment_method_enum NOT NULL,
    provider_transaction_id VARCHAR(255),
    status payment_status_enum DEFAULT 'pending',
    metadata JSONB,
    processed_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ã‚³ã‚¤ãƒ³å–å¼•ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE coin_transactions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    amount INTEGER NOT NULL, -- æ­£æ•°=ç²å¾—ã€è² æ•°=æ¶ˆè²»
    balance_after INTEGER NOT NULL,
    transaction_type coin_transaction_type_enum NOT NULL,
    reference_id INTEGER, -- payment_id ã‚„ gacha_result_id ãªã©
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ãƒã‚¤ãƒ³ãƒˆå–å¼•ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE points_transactions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    amount INTEGER NOT NULL,
    balance_after INTEGER NOT NULL,
    transaction_type points_transaction_type_enum NOT NULL,
    reference_id INTEGER,
    expires_at TIMESTAMP,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ğŸ æ‹›å¾…ã‚·ã‚¹ãƒ†ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
-- æ‹›å¾…ã‚³ãƒ¼ãƒ‰ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE invite_codes (
    id SERIAL PRIMARY KEY,
    code VARCHAR(8) UNIQUE NOT NULL,
    created_by INTEGER REFERENCES users(id),
    used_by INTEGER REFERENCES users(id),
    used_at TIMESTAMP,
    expires_at TIMESTAMP NOT NULL,
    referral_bonus_percentage DECIMAL(3,2) DEFAULT 1.00,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ‹›å¾…çµ±è¨ˆãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE invite_stats (
    id SERIAL PRIMARY KEY,
    user_id INTEGER UNIQUE REFERENCES users(id),
    codes_generated INTEGER DEFAULT 0,
    successful_invites INTEGER DEFAULT 0,
    total_bonus_earned DECIMAL(10,2) DEFAULT 0,
    last_invite_at TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### ğŸ“‹ ENUMå®šç¾©

```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼å½¹å‰²
CREATE TYPE user_role_enum AS ENUM ('user', 'admin', 'moderator');

-- ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹
CREATE TYPE user_status_enum AS ENUM ('active', 'inactive', 'suspended', 'banned');

-- OTPç”¨é€”
CREATE TYPE otp_purpose_enum AS ENUM ('registration', 'login', 'password_reset', 'email_change');

-- ãƒ¬ã‚¢ãƒªãƒ†ã‚£
CREATE TYPE rarity_enum AS ENUM ('normal', 'rare', 'super_rare');

-- æ±ºæ¸ˆæ–¹æ³•
CREATE TYPE payment_method_enum AS ENUM ('stripe', 'paypay');

-- æ±ºæ¸ˆçŠ¶æ…‹
CREATE TYPE payment_status_enum AS ENUM ('pending', 'completed', 'failed', 'refunded');

-- ã‚³ã‚¤ãƒ³å–å¼•ç¨®é¡
CREATE TYPE coin_transaction_type_enum AS ENUM ('purchase', 'gacha_draw', 'refund', 'bonus');

-- ãƒã‚¤ãƒ³ãƒˆå–å¼•ç¨®é¡
CREATE TYPE points_transaction_type_enum AS ENUM ('gacha_reward', 'referral_bonus', 'exchange', 'expiry');
```

### ğŸ” ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æˆ¦ç•¥

```sql
-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_status ON users(status);
CREATE INDEX idx_users_referred_by ON users(referred_by);

CREATE INDEX idx_gacha_results_user_id ON gacha_results(user_id);
CREATE INDEX idx_gacha_results_gacha_id ON gacha_results(gacha_id);
CREATE INDEX idx_gacha_results_performed_at ON gacha_results(performed_at);

CREATE INDEX idx_payments_user_id ON payments(user_id);
CREATE INDEX idx_payments_status ON payments(status);
CREATE INDEX idx_payments_created_at ON payments(created_at);

CREATE INDEX idx_coin_transactions_user_id ON coin_transactions(user_id);
CREATE INDEX idx_coin_transactions_created_at ON coin_transactions(created_at);

CREATE INDEX idx_invite_codes_code ON invite_codes(code);
CREATE INDEX idx_invite_codes_created_by ON invite_codes(created_by);
CREATE INDEX idx_invite_codes_expires_at ON invite_codes(expires_at);
```

---

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

### ğŸ“‹ äº‹å‰æº–å‚™

#### ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶
- **Node.js**: v18.0.0 ä»¥ä¸Š
- **npm**: v8.0.0 ä»¥ä¸Š
- **PostgreSQL**: v13.0 ä»¥ä¸Š
- **Redis**: v6.0 ä»¥ä¸Š (ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç”¨)
- **Git**: v2.30 ä»¥ä¸Š

#### å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹æº–å‚™
- **AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** (S3, SESç”¨)
- **Stripe ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** (æ±ºæ¸ˆç”¨)
- **PayPay for Developers ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** (PayPayæ±ºæ¸ˆç”¨)
- **Gmail App Password** (ãƒ¡ãƒ¼ãƒ«é€ä¿¡ç”¨)

### ğŸ“¥ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †

#### 1. ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/your-username/online-gacha-final.git
cd online-gacha-final

# ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å…¨ä½“ä¾å­˜é–¢ä¿‚ç¢ºèª
npm run install:all
```

#### 2. PostgreSQL ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# PostgreSQL ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« (Ubuntu/Debian)
sudo apt update
sudo apt install postgresql postgresql-contrib

# PostgreSQL èµ·å‹•
sudo systemctl start postgresql
sudo systemctl enable postgresql

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ
sudo -u postgres psql
CREATE DATABASE gacha;
CREATE USER gacha_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE gacha TO gacha_user;
\q
```

#### 3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç’°å¢ƒæ§‹ç¯‰

```bash
cd backend

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
cp .env.example .env
```

**.env ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®šä¾‹:**
```bash
# ã‚µãƒ¼ãƒãƒ¼è¨­å®š
PORT=3001
NODE_ENV=development

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=gacha_user
DB_PASSWORD=your_password
DB_NAME=gacha

# JWTè¨­å®š
JWT_SECRET=your-super-secret-jwt-key-here
JWT_EXPIRES_IN=24h

# AWS S3è¨­å®š
AWS_ACCESS_KEY_ID=AKIA...
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_REGION=ap-northeast-1
S3_BUCKET_NAME=your-gacha-bucket

# Stripeè¨­å®š
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# PayPayè¨­å®š
PAYPAY_API_KEY=your-paypay-key
PAYPAY_API_SECRET=your-paypay-secret
PAYPAY_MERCHANT_ID=your-merchant-id
PAYPAY_ENVIRONMENT=sandbox

# LINE Botè¨­å®š
LINE_CHANNEL_ACCESS_TOKEN=your-line-access-token
LINE_CLIENT_SECRET=your-line-client-secret

# ãƒ¡ãƒ¼ãƒ«è¨­å®š
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-app-password
EMAIL_FROM="SHIJON Support <noreply@shijon.com>"

# Redisè¨­å®š (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# ãƒ­ã‚°è¨­å®š
LOG_LEVEL=debug
LOG_FILE_PATH=./logs
```

#### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
npm run typeorm:run-migrations

# åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
npm run seed:run
```

#### 5. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰èµ·å‹•ç¢ºèª

```bash
# é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
npm run start:dev

# ã¾ãŸã¯æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
npm run build
npm run start:prod
```

èµ·å‹•ç¢ºèª:
- API: http://localhost:3001
- Swaggeræ–‡æ›¸: http://localhost:3001/api

#### 6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒæ§‹ç¯‰

```bash
cd ../frontend

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
cp .env.local.example .env.local
```

**.env.local ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®šä¾‹:**
```bash
# APIè¨­å®š
NEXT_PUBLIC_API_URL=http://localhost:3001
NEXT_PUBLIC_WS_URL=ws://localhost:3001

# Stripeå…¬é–‹ã‚­ãƒ¼
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...

# PayPayè¨­å®š
NEXT_PUBLIC_PAYPAY_CLIENT_ID=your-paypay-client-id

# ãã®ä»–è¨­å®š
NEXT_PUBLIC_APP_NAME=SHIJON
NEXT_PUBLIC_APP_VERSION=1.0.0
NEXT_PUBLIC_ENVIRONMENT=development
```

#### 7. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èµ·å‹•ç¢ºèª

```bash
# é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•
npm run dev

# ã¾ãŸã¯æœ¬ç•ªãƒ“ãƒ«ãƒ‰
npm run build
npm start
```

èµ·å‹•ç¢ºèª:
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³: http://localhost:3000

### ğŸ”§ é–‹ç™ºç’°å¢ƒè¿½åŠ è¨­å®š

#### VS Code æ‹¡å¼µæ©Ÿèƒ½æ¨å¥¨

```json
// .vscode/extensions.json
{
  "recommendations": [
    "bradlc.vscode-tailwindcss",
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint",
    "ms-vscode.vscode-typescript-next",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-json"
  ]
}
```

#### Git ãƒ•ãƒƒã‚¯è¨­å®š

```bash
# Husky ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— (ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰)
cd frontend
npx husky install
npx husky add .husky/pre-commit "npm run lint"
npx husky add .husky/pre-push "npm run test"
```

#### Dockerç’°å¢ƒ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

```yaml
# docker-compose.yml
version: '3.8'
services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: gacha
      POSTGRES_USER: gacha_user
      POSTGRES_PASSWORD: your_password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

volumes:
  postgres_data:
```

```bash
# Dockerç’°å¢ƒèµ·å‹•
docker-compose up -d
```

---

## ğŸ”§ è¨­å®šè©³ç´°

### âš™ï¸ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨­å®š

#### ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š

```typescript
// backend/src/config/database.config.ts
import { ConfigService } from '@nestjs/config';
import { TypeOrmModuleOptions } from '@nestjs/typeorm';

export const databaseConfig = (configService: ConfigService): TypeOrmModuleOptions => ({
  type: 'postgres',
  host: configService.get('DB_HOST'),
  port: parseInt(configService.get('DB_PORT'), 10),
  username: configService.get('DB_USERNAME'),
  password: configService.get('DB_PASSWORD'),
  database: configService.get('DB_NAME'),
  entities: ['dist/**/*.entity{.ts,.js}'],
  migrations: ['dist/migrations/*{.ts,.js}'],
  synchronize: configService.get('NODE_ENV') === 'development',
  logging: configService.get('NODE_ENV') === 'development',
  ssl: configService.get('NODE_ENV') === 'production' ? { rejectUnauthorized: false } : false,
  extra: {
    max: 20, // æœ€å¤§æ¥ç¶šæ•°
    idleTimeoutMillis: 30000,
    connectionTimeoutMillis: 2000,
  },
});
```

#### ğŸ” JWTè¨­å®š

```typescript
// backend/src/config/jwt.config.ts
import { ConfigService } from '@nestjs/config';
import { JwtModuleOptions } from '@nestjs/jwt';

export const jwtConfig = (configService: ConfigService): JwtModuleOptions => ({
  secret: configService.get('JWT_SECRET'),
  signOptions: {
    expiresIn: configService.get('JWT_EXPIRES_IN', '24h'),
    issuer: 'SHIJON',
    audience: 'SHIJON-API',
  },
});
```

#### ğŸ’³ æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¨­å®š

```typescript
// backend/src/config/payment.config.ts
export const stripeConfig = {
  secretKey: process.env.STRIPE_SECRET_KEY,
  publicKey: process.env.STRIPE_PUBLISHABLE_KEY,
  webhookSecret: process.env.STRIPE_WEBHOOK_SECRET,
  currency: 'jpy',
  paymentMethodTypes: ['card'],
};

export const paypayConfig = {
  apiKey: process.env.PAYPAY_API_KEY,
  apiSecret: process.env.PAYPAY_API_SECRET,
  merchantId: process.env.PAYPAY_MERCHANT_ID,
  environment: process.env.PAYPAY_ENVIRONMENT || 'sandbox',
  currency: 'JPY',
};
```

### ğŸŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­å®š

#### ğŸ¨ Tailwind CSSè¨­å®š

```javascript
// frontend/tailwind.config.js
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          900: '#1e3a8a',
        },
        gacha: {
          normal: '#6b7280',
          rare: '#3b82f6',
          super: '#f59e0b',
        },
      },
      animation: {
        'gacha-spin': 'spin 2s linear infinite',
        'card-flip': 'flip 0.8s ease-in-out',
      },
    },
  },
  plugins: [
    require('@tailwindcss/forms'),
    require('@tailwindcss/typography'),
  ],
}
```

#### ğŸ—ƒï¸ Reduxè¨­å®š

```typescript
// frontend/redux/store.ts
import { configureStore } from '@reduxjs/toolkit';
import { persistStore, persistReducer } from 'redux-persist';
import storage from 'redux-persist/lib/storage';

const persistConfig = {
  key: 'root',
  storage,
  whitelist: ['auth', 'user'], // æ°¸ç¶šåŒ–ã™ã‚‹ã‚¹ãƒ©ã‚¤ã‚¹
};

export const store = configureStore({
  reducer: {
    auth: persistReducer(persistConfig, authSlice.reducer),
    user: userSlice.reducer,
    gacha: gachaSlice.reducer,
    payment: paymentSlice.reducer,
    admin: adminSlice.reducer,
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: [FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER],
      },
    }),
  devTools: process.env.NODE_ENV !== 'production',
});

export const persistor = persistStore(store);
export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;
```

## ğŸ“š APIä»•æ§˜

### ğŸ”— APIãƒ™ãƒ¼ã‚¹URL

- **é–‹ç™ºç’°å¢ƒ**: `http://localhost:3001`
- **æœ¬ç•ªç’°å¢ƒ**: `https://api.shijon.com`
- **APIæ–‡æ›¸**: `{BASE_URL}/api` (Swagger UI)

### ğŸ” èªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### POST /auth/register
**æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²**

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "email": "user@example.com",
  "password": "securePassword123",
  "username": "username",
  "inviteCode": "ABC12345" // ã‚ªãƒ—ã‚·ãƒ§ãƒ³
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (201):**
```json
{
  "success": true,
  "message": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚OTPãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸã€‚",
  "data": {
    "userId": 123,
    "email": "user@example.com",
    "status": "inactive"
  }
}
```

#### POST /auth/verify-otp
**OTPèªè¨¼**

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "email": "user@example.com",
  "code": "123456"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200):**
```json
{
  "success": true,
  "message": "èªè¨¼ãŒå®Œäº†ã—ã¾ã—ãŸ",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 123,
      "email": "user@example.com",
      "username": "username",
      "role": "user",
      "status": "active"
    }
  }
}
```

#### POST /auth/login
**ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³**

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200):**
```json
{
  "success": true,
  "message": "ãƒ­ã‚°ã‚¤ãƒ³ãŒå®Œäº†ã—ã¾ã—ãŸ",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 123,
      "email": "user@example.com",
      "username": "username",
      "role": "user",
      "coinBalance": 1000,
      "pointBalance": 500
    }
  }
}
```

### ğŸ° ã‚¬ãƒãƒ£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### GET /gacha
**åˆ©ç”¨å¯èƒ½ã‚¬ãƒãƒ£ä¸€è¦§å–å¾—**

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200):**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¬ãƒãƒ£",
      "description": "ãƒ¬ã‚¢ã‚«ãƒ¼ãƒ‰ãŒå‡ºã‚„ã™ã„ç‰¹åˆ¥ã‚¬ãƒãƒ£",
      "price": 300,
      "imageUrl": "https://s3.amazonaws.com/gacha1.jpg",
      "videoUrl": "https://s3.amazonaws.com/gacha1.mp4",
      "isActive": true,
      "remainingStock": 100,
      "startDate": "2024-01-01T00:00:00Z",
      "endDate": "2024-12-31T23:59:59Z",
      "items": [
        {
          "id": 1,
          "rarity": "super_rare",
          "probability": 0.05,
          "stock": 10,
          "prize": {
            "id": 1,
            "name": "ãƒ‰ãƒ©ã‚´ãƒ³ã‚«ãƒ¼ãƒ‰",
            "imageUrl": "https://s3.amazonaws.com/dragon.jpg",
            "points": 1000
          }
        }
      ]
    }
  ],
  "pagination": {
    "total": 1,
    "page": 1,
    "limit": 10
  }
}
```

#### POST /gacha/draw
**ã‚¬ãƒãƒ£å®Ÿè¡Œ**

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "gachaId": 1,
  "quantity": 1 // 1 or 10
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200):**
```json
{
  "success": true,
  "message": "ã‚¬ãƒãƒ£ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ",
  "data": {
    "results": [
      {
        "id": 1001,
        "gachaItemId": 1,
        "quantity": 1,
        "pointsAwarded": 1000,
        "rarity": "super_rare",
        "prize": {
          "id": 1,
          "name": "ãƒ‰ãƒ©ã‚´ãƒ³ã‚«ãƒ¼ãƒ‰",
          "imageUrl": "https://s3.amazonaws.com/dragon.jpg",
          "points": 1000
        }
      }
    ],
    "totalPointsAwarded": 1000,
    "newCoinBalance": 700,
    "newPointBalance": 1500
  }
}
```

### ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### GET /profile
**ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±å–å¾—**

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200):**
```json
{
  "success": true,
  "data": {
    "user": {
      "id": 123,
      "email": "user@example.com",
      "username": "username",
      "role": "user",
      "status": "active",
      "createdAt": "2024-01-01T00:00:00Z"
    },
    "profile": {
      "firstName": "å¤ªéƒ",
      "lastName": "ç”°ä¸­",
      "phone": "090-1234-5678",
      "address": "æ±äº¬éƒ½æ¸‹è°·åŒº...",
      "avatarUrl": "https://s3.amazonaws.com/avatar.jpg",
      "language": "ja",
      "timezone": "Asia/Tokyo"
    },
    "balances": {
      "coins": 1000,
      "points": 500
    },
    "stats": {
      "totalGachaDraws": 50,
      "totalPointsEarned": 10000,
      "invitesGenerated": 5,
      "successfulInvites": 2
    }
  }
}
```

#### PUT /profile
**ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°**

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "firstName": "å¤ªéƒ",
  "lastName": "ç”°ä¸­",
  "phone": "090-1234-5678",
  "address": "æ±äº¬éƒ½æ¸‹è°·åŒº...",
  "language": "ja",
  "timezone": "Asia/Tokyo"
}
```

### ğŸ æ‹›å¾…ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### POST /invite/generate
**æ‹›å¾…ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ**

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (201):**
```json
{
  "success": true,
  "message": "æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸ",
  "data": {
    "code": "ABC12345",
    "expiresAt": "2024-01-08T00:00:00Z",
    "referralBonusPercentage": 1.0
  }
}
```

#### GET /invite/stats
**æ‹›å¾…çµ±è¨ˆå–å¾—**

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200):**
```json
{
  "success": true,
  "data": {
    "codesGenerated": 5,
    "successfulInvites": 2,
    "totalBonusEarned": 150.00,
    "activeCodes": 1,
    "lastInviteAt": "2024-01-01T00:00:00Z"
  }
}
```

### ğŸ’° æ±ºæ¸ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### POST /payments/stripe
**Stripeæ±ºæ¸ˆå‡¦ç†**

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "amount": 1000,
  "currency": "jpy",
  "paymentMethodId": "pm_1234567890"
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (200):**
```json
{
  "success": true,
  "message": "æ±ºæ¸ˆãŒå®Œäº†ã—ã¾ã—ãŸ",
  "data": {
    "paymentId": "payment_123",
    "amount": 1000,
    "currency": "jpy",
    "status": "completed",
    "coinsAdded": 1000,
    "newCoinBalance": 2000
  }
}
```

#### POST /payments/paypay
**PayPayæ±ºæ¸ˆå‡¦ç†**

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ:**
```json
{
  "amount": 1000,
  "orderInfo": {
    "merchantPaymentId": "order_123",
    "codeType": "ORDER_QR"
  }
}
```

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…

### ğŸ›¡ï¸ èªè¨¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

#### JWTå®Ÿè£…è©³ç´°
```typescript
// JWTæˆ¦ç•¥è¨­å®š
@Injectable()
export class JwtStrategy extends PassportStrategy(Strategy) {
  constructor(private configService: ConfigService) {
    super({
      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
      ignoreExpiration: false,
      secretOrKey: configService.get('JWT_SECRET'),
      issuer: 'SHIJON',
      audience: 'SHIJON-API',
    });
  }

  async validate(payload: any) {
    return {
      userId: payload.sub,
      email: payload.email,
      role: payload.role,
    };
  }
}
```

#### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
```typescript
// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–
@Injectable()
export class AuthService {
  async hashPassword(password: string): Promise<string> {
    const saltRounds = 12;
    return await bcrypt.hash(password, saltRounds);
  }

  async validatePassword(password: string, hash: string): Promise<boolean> {
    return await bcrypt.compare(password, hash);
  }

  // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦æ¤œè¨¼
  validatePasswordStrength(password: string): boolean {
    const minLength = 8;
    const hasUpperCase = /[A-Z]/.test(password);
    const hasLowerCase = /[a-z]/.test(password);
    const hasNumbers = /\d/.test(password);
    const hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);

    return password.length >= minLength && 
           hasUpperCase && 
           hasLowerCase && 
           hasNumbers && 
           hasSpecialChar;
  }
}
```

### ğŸ” API ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

#### Rate Limitingå®Ÿè£…
```typescript
// ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­å®š
@Controller('auth')
@UseGuards(ThrottlerGuard)
export class AuthController {
  @Post('login')
  @Throttle(5, 60) // 1åˆ†é–“ã«5å›ã¾ã§
  async login(@Body() loginDto: LoginDto) {
    return this.authService.login(loginDto);
  }

  @Post('register')
  @Throttle(3, 3600) // 1æ™‚é–“ã«3å›ã¾ã§
  async register(@Body() registerDto: RegisterDto) {
    return this.authService.register(registerDto);
  }
}
```

#### CORSè¨­å®š
```typescript
// CORSè¨­å®š
app.enableCors({
  origin: process.env.NODE_ENV === 'production' 
    ? ['https://shijon.com', 'https://www.shijon.com']
    : ['http://localhost:3000'],
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],
  allowedHeaders: ['Content-Type', 'Authorization'],
  credentials: true,
});
```

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
```typescript
// Helmetè¨­å®š
app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      scriptSrc: ["'self'", "'unsafe-inline'", "https://js.stripe.com"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      imgSrc: ["'self'", "data:", "https:"],
      connectSrc: ["'self'", "https://api.stripe.com"],
      frameSrc: ["https://js.stripe.com"],
    },
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true,
  },
}));
```

### ğŸ“Š ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°

#### ãƒ­ã‚°è¨˜éŒ²ã‚·ã‚¹ãƒ†ãƒ 
```typescript
@Injectable()
export class SecurityService {
  async logSecurityEvent(event: SecurityEvent) {
    const log = new SecurityLog();
    log.userId = event.userId;
    log.action = event.action;
    log.ipAddress = event.ipAddress;
    log.userAgent = event.userAgent;
    log.details = event.details;
    log.severity = event.severity;
    log.timestamp = new Date();

    await this.securityLogRepository.save(log);

    // é‡è¦åº¦ãŒé«˜ã„å ´åˆã¯ç®¡ç†è€…ã«é€šçŸ¥
    if (event.severity === 'HIGH') {
      await this.notifyAdmins(log);
    }
  }

  // ä¸å¯©ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£æ¤œå‡º
  async detectSuspiciousActivity(userId: number): Promise<boolean> {
    const recentLogs = await this.securityLogRepository.find({
      where: { userId, timestamp: MoreThan(new Date(Date.now() - 3600000)) },
      order: { timestamp: 'DESC' },
    });

    // 1æ™‚é–“ä»¥å†…ã«10å›ä»¥ä¸Šã®å¤±æ•—ãƒ­ã‚°ã‚¤ãƒ³
    const failedLogins = recentLogs.filter(log => 
      log.action === 'LOGIN_FAILED'
    );

    return failedLogins.length >= 10;
  }
}
```

### ğŸ’³ æ±ºæ¸ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

#### Stripe Webhookæ¤œè¨¼
```typescript
@Controller('webhooks')
export class WebhookController {
  @Post('stripe')
  async handleStripeWebhook(
    @Req() req: Request,
    @Headers('stripe-signature') signature: string
  ) {
    let event: Stripe.Event;

    try {
      // Webhookç½²åæ¤œè¨¼
      event = this.stripe.webhooks.constructEvent(
        req.body,
        signature,
        process.env.STRIPE_WEBHOOK_SECRET
      );
    } catch (err) {
      throw new BadRequestException('Invalid webhook signature');
    }

    // å†ªç­‰æ€§ãƒã‚§ãƒƒã‚¯
    const existingEvent = await this.webhookEventRepository.findOne({
      where: { stripeEventId: event.id }
    });

    if (existingEvent) {
      return { received: true };
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
    await this.processWebhookEvent(event);
    
    return { received: true };
  }
}
```

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### ğŸ—ï¸ ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£

#### AWS EC2 è¨­å®š
```bash
# EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åˆæœŸè¨­å®š
sudo apt update && sudo apt upgrade -y

# Node.js ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# PM2 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo npm install -g pm2

# Nginx ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt install nginx -y

# PostgreSQL ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt install postgresql postgresql-contrib -y

# SSLè¨¼æ˜æ›¸ (Let's Encrypt)
sudo apt install certbot python3-certbot-nginx -y
```

#### Nginxè¨­å®š
```nginx
# /etc/nginx/sites-available/shijon
server {
    listen 80;
    server_name shijon.com www.shijon.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name shijon.com www.shijon.com;

    ssl_certificate /etc/letsencrypt/live/shijon.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/shijon.com/privkey.pem;

    # SSLè¨­å®š
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    ssl_prefer_server_ciphers off;
    ssl_session_cache shared:SSL:10m;

    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Strict-Transport-Security "max-age=63072000" always;

    # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # API
    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # APIå°‚ç”¨è¨­å®š
        client_max_body_size 10M;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
    location /uploads {
        root /var/www/shijon;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

### ğŸ”„ CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

#### GitHub Actionsè¨­å®š
```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_PASSWORD: test
          POSTGRES_DB: gacha_test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5

    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        cache-dependency-path: |
          backend/package-lock.json
          frontend/package-lock.json

    - name: Install Backend Dependencies
      run: |
        cd backend
        npm ci

    - name: Install Frontend Dependencies
      run: |
        cd frontend
        npm ci

    - name: Run Backend Tests
      run: |
        cd backend
        npm run test:cov
      env:
        DATABASE_URL: postgres://postgres:test@localhost:5432/gacha_test

    - name: Run Frontend Tests
      run: |
        cd frontend
        npm run test:ci

    - name: Build Backend
      run: |
        cd backend
        npm run build

    - name: Build Frontend
      run: |
        cd frontend
        npm run build

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'

    steps:
    - uses: actions/checkout@v4

    - name: Deploy to Server
      uses: appleboy/ssh-action@v0.1.5
      with:
        host: ${{ secrets.EC2_HOST }}
        username: ${{ secrets.EC2_USER }}
        key: ${{ secrets.EC2_PRIVATE_KEY }}
        script: |
          cd /var/www/shijon
          git pull origin main
          
          # Backend Deploy
          cd backend
          npm ci --production
          npm run build
          pm2 restart gacha-backend
          
          # Frontend Deploy  
          cd ../frontend
          npm ci --production
          npm run build
          pm2 restart gacha-frontend
          
          # Nginx reload
          sudo nginx -t && sudo systemctl reload nginx
```

### ğŸ“¦ PM2 ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†

#### PM2 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```javascript
// ecosystem.config.js
module.exports = {
  apps: [
    {
      name: 'gacha-backend',
      script: './backend/dist/main.js',
      cwd: '/var/www/shijon',
      instances: 2,
      exec_mode: 'cluster',
      env: {
        NODE_ENV: 'production',
        PORT: 3001,
      },
      log_file: '/var/log/pm2/gacha-backend.log',
      out_file: '/var/log/pm2/gacha-backend-out.log',
      error_file: '/var/log/pm2/gacha-backend-error.log',
      merge_logs: true,
      time: true,
      max_memory_restart: '1G',
      node_args: '--max-old-space-size=1024',
    },
    {
      name: 'gacha-frontend',
      script: 'npm',
      args: 'start',
      cwd: '/var/www/shijon/frontend',
      instances: 1,
      env: {
        NODE_ENV: 'production',
        PORT: 3000,
      },
      log_file: '/var/log/pm2/gacha-frontend.log',
      max_memory_restart: '512M',
    }
  ],

  deploy: {
    production: {
      user: 'ubuntu',
      host: 'your-ec2-host',
      ref: 'origin/main',
      repo: 'git@github.com:your-username/online-gacha-final.git',
      path: '/var/www/shijon',
      'post-deploy': 'npm install && pm2 reload ecosystem.config.js --env production',
    }
  }
};
```

### ğŸ“Š ç›£è¦–ãƒ»ãƒ­ã‚°ç®¡ç†

#### ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
```bash
# /etc/logrotate.d/gacha
/var/log/pm2/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 ubuntu ubuntu
    postrotate
        pm2 reloadLogs
    endscript
}
```

#### ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```bash
#!/bin/bash
# /usr/local/bin/monitor-gacha.sh

# CPUä½¿ç”¨ç‡ãƒã‚§ãƒƒã‚¯
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
if (( $(echo "$CPU_USAGE > 80" | bc -l) )); then
    echo "High CPU usage: $CPU_USAGE%" | mail -s "ALERT: High CPU" admin@shijon.com
fi

# ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãƒã‚§ãƒƒã‚¯
MEM_USAGE=$(free | grep Mem | awk '{printf("%.1f", $3/$2 * 100.0)}')
if (( $(echo "$MEM_USAGE > 85" | bc -l) )); then
    echo "High memory usage: $MEM_USAGE%" | mail -s "ALERT: High Memory" admin@shijon.com
fi

# PM2ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª
pm2 jlist | jq -r '.[] | select(.pm2_env.status != "online") | .name' | while read -r app; do
    echo "Application $app is not running" | mail -s "ALERT: App Down" admin@shijon.com
    pm2 restart "$app"
done

# ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãƒã‚§ãƒƒã‚¯
DISK_USAGE=$(df -h / | awk 'NR==2 {print $5}' | cut -d'%' -f1)
if [ "$DISK_USAGE" -gt 85 ]; then
    echo "Disk usage is $DISK_USAGE%" | mail -s "ALERT: High Disk Usage" admin@shijon.com
fi
```

## ğŸ¤ é–‹ç™ºã‚¬ã‚¤ãƒ‰

1. Forkã—ã¦ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
2. æ©Ÿèƒ½é–‹ç™ºãƒ»ãƒã‚°ä¿®æ­£
3. ãƒ†ã‚¹ãƒˆè¿½åŠ 
4. Pull Requestä½œæˆ

### é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
- **ã‚³ãƒŸãƒƒãƒˆè¦ç´„**: Conventional Commits
- **ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«**: ESLint + Prettier
- **å‘½åè¦å‰‡**: camelCase (JS/TS), kebab-case (CSS)

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License - è©³ç´°ã¯[LICENSE](LICENSE)ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼**
   - PostgreSQLã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ç¢ºèª
   - æ¥ç¶šæƒ…å ±ç¢ºèª

2. **ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼**
   - Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
   - node_moduleså‰Šé™¤å¾Œå†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

3. **èªè¨¼ã‚¨ãƒ©ãƒ¼**
   - JWT_SECRETè¨­å®šç¢ºèª
   - ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™ç¢ºèª

---

**é–‹ç™ºãƒãƒ¼ãƒ **: SHIJON Development Team  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0  
